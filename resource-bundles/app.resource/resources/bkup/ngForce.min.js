/*! ngForce 2014-08-29 */
/*! visit https://noeticpenguin.github.io/ngForce for more info. */

"use strict";angular.module("ngForce").factory("encodeUriQuery",function(){function a(a,b){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,b?"%20":"+")}return a}),angular.module("ngForce").provider("remoteObjects",function(){var a="SObjectModel";this.setNamespace=function(b){_.isUndefined(b)||(a=b)},this.$get=["$q","$log",function(b){var c={getPromiseObj:function(c){var d={};return d.remoteObj=new a[c],d.retrieve=function(){d.remoteObj.retrieve(opts,this.handleWithPromise)},d.create=function(a){a=a?a:d.remoteObj._props,d.remoteObj.create(a,handleWithPromise)},d.update=function(a,b){angular._isArray(a)||(b=a,a=null),a=a?a:[d.remoteObj._props.Id],b=b?b:d.remoteObj._props,d.remoteObj.update(a,b,handleWithPromise)},d.del=function(a){a=a?a:[d.remoteObj._props.Id],d.remoteObj.del(a,handleWithPromise)},handleWithPromise=function(a,c,d){var e=b.defer();return a?e.reject(a):d?e.resolve(c,d):e.resolve(c),e.promise},d}};return c}]}),angular.module("ngForce").provider("sfTemplate",function(){var a=[".ajax4jsf.javascript.AjaxScript","/js/perf/stub.js","/sfdc/JiffyStubs.js"];this.setScriptSymbolBlacklist=function(b){if(!(angular.isArray(b)&&b.length>0))throw new Error("newBlacklist must be an array!");a=b},this.$get=["$q","$http","$templateCache","$log",function(b,c,d){var e=function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},f=function(a){var b=_.map(a,e),c=_.map(b,function(a){return".*"+a+".*?"}),d="("+c.join("|")+")",f='<script src="'+d+'"></script>',g=new RegExp(f,"gi");return g},g=function(b){var c=f(a),d=b.replace(c,"");return d},h={fromVf:function(a){var b=c.get(a,{cache:d}).then(function(a){return a.data}).then(g);return b}};return h}]}),angular.module("ngForce").factory("sfr",["$q","$rootScope","Restangular","$log",function(a,b,c,d){var e=[],f=[],g={model:function(a,b){var d,e=c.setDefaultHeaders({Authorization:"Bearer "+window.apiSid}).setBaseUrl("/services/data/v29.0/sobjects/").setRestangularFields({id:"Id",selfLink:"attributes.url"});return d=b?e.one(a,b):e.all(a)},insert:function(b,c,f){var g=a.defer();if(!angular.isString(b))return g.reject("An sObject name is required to perform insert."),g.promise;var h=angular.isDefined(f)?f:!1,i=e[b];return angular.isUndefined(i)&&(i=this.model(b),e[b]=i),i.post(c).then(function(a){return a.success?(d.debug("ngForce: Created new "+b+" record:",a),g.resolve(a),h?i.get(a.id).then(function(a){return d.debug("ngForce: Inserted:",a),a}):g.promise):(g.reject("Insert failed: ["+a.errors+"] Full response: "+a),g.promise)})},update:function(b,c,e){var g=a.defer();if(!angular.isString(b))return g.reject("An sObject name is required to perform an update."),g.promise;var h=angular.isDefined(e)?e:!1,i=c.id||c.Id;if(!angular.isString(i))return g.reject('An "Id" field is required to perform an update.'),g.promise;var j=f[i];angular.isUndefined(j)&&(j=this.model(b,i),f[i]=j);for(var k=["Id","LastReferencedDate","LastModifiedById","LastModifiedDate","LastViewedDate","SystemModstamp","CreatedById","CreatedDate","IsDeleted"],l=0;l<k.length;l++){var m=k[l];delete c[m]}return j.patch(c).then(function(a){return d.debug("ngForce: Patched "+b+" record:",c),h?j.get().then(function(c){return d.debug("ngForce: Updated "+b+" record:",a),c}):(g.resolve("Patch successful!"),g.promise)})},"delete":function(b,c){var e=a.defer();if(!angular.isString(b))return e.reject("An sObject name is required to perform a delete."),e.promise;var g=c.id||c.Id;if(!angular.isString(g))return e.reject('An "Id" field is required to perform a delete.'),e.promise;var h=f[g];return angular.isUndefined(h)&&(h=this.model(b,g),f[g]=h),h.remove().then(function(){return d.debug("ngForce: Deleted "+b+" record:",g),e.resolve("Delete successful!"),e.promise})}};return g}]),angular.module("ngForce").factory("sfranalytics",["$q","$rootScope","Restangular",function(a,b,c){var d="/services/data/v29.0/analytics/",e={Authorization:"Bearer "+window.apiSid},f=c.withConfig(function(a){a.setBaseUrl(d),a.setDefaultHeaders(e)}).setRestangularFields({id:"Id"});return{analytics:function(){return f.all("reports")},reports:{metadata:function(a){return f.one("reports",a).get("metadata")},run:function(b,c){if("object"!=typeof c&&(c={}),c.async===!0)throw"Asnynchronous report runs are not supported at this time";var d={};(c.includeDetails===!0||c.includeDetails===!1)&&(d.includeDetails=c.includeDetails);var e=c.reportFilters&&c.reportFilters.length>0;if(e===!0){var g=a.defer();return this.metadata(b).then(function(a){var e=a.reportMetadata;("string"==typeof c.reportBooleanFilter||null===c.reportBooleanFilter)&&(e.reportBooleanFilter=c.reportBooleanFilter),"[object Array]"===Object.prototype.toString.call(c.reportFilters)&&(e.reportFilters=c.reportFilters),f.one("reports").post(b,{reportMetadata:e},d).then(function(a){g.resolve(a)},function(a){g.reject(a)})}),g.promise}return f.one("reports",b).get(d)}},dashboard:{}}}]),angular.module("ngForce").factory("sfrBackend",["$q","$rootScope","$log","$httpBackend","encodeUriQuery",function(a,b,c,d,e){var f=function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},g={whenGetPage:function(a,b){var c=a;-1==c.indexOf("/apex/")&&(c="/apex/"+c);var e=f(c);d.whenGET(new RegExp(e,"i")).respond(b)},whenQuery:function(a,b,c){var g=angular.isString(c)?[c]:c,h=angular.isArray(b)?b:[b],i="query.*FROM\\++"+a;if("undefined"!=typeof g&&null!==g){var j=_.chain(g).map(function(a){return e(a)}).foldl(function(a,b){return a+=b}).value();i+="\\++WHERE.*"+f(j)}d.whenGET(new RegExp(i,"i")).respond(200,{totalSize:h.length,done:!0,records:h})},expectQuery:function(a,b,c){var g=angular.isString(c)?[c]:c,h=angular.isArray(b)?b:[b],i="query.*FROM\\++"+a;if("undefined"!=typeof g&&null!==g){var j=_.chain(g).map(function(a){return e(a)}).foldl(function(a,b){return a+=b}).value();i+="\\++WHERE.*"+f(j)}d.expectGET(new RegExp(i,"i")).respond(200,{totalSize:h.length,done:!0,records:h})},expectInsert:function(a,b,c){var e=angular.isArray(b)?b:[b],f=c||!0;angular.forEach(e,function(b){d.expectPOST(new RegExp(a,"i")).respond(201,{id:b.Id,success:!0,errors:[]}),f||d.expectGET(new RegExp(a+"/"+b.Id,"i")).respond(200,b)})},expectDelete:function(a,b){b=b||"";var c=angular.isArray(b)?b:[b];angular.forEach(c,function(b){d.expectDELETE(new RegExp(a+"/"+b,"i")).respond(201,{})})}};return g}]),angular.module("ngForce").factory("sfrfile",["$q","$rootScope","$log","Restangular","MultipartRequest","RequestPart",function(a,b,c,d,e,f){var g=d.withConfig(function(a){a.setDefaultHttpFields({cache:!1,transformRequest:function(a){return a}}),a.setBaseUrl("/services/data/v29.0/sobjects"),a.setDefaultHeaders({Authorization:"Bearer "+window.apiSid})}).setRestangularFields({id:"Id",selfLink:"attributes.url"});return g.insert=function(a,b,c,d){SObjectType={Document:{jsonPartName:"entity_document",binaryPartName:"Body"},Attachment:{jsonPartName:"entity_attachment",binaryPartName:"Body"},ContentVersion:{jsonPartName:"entity_content",binaryPartName:"VersionData"}};var h=SObjectType[a];if(void 0===typeof h)throw new Error("Upload not supported for SObject type '"+a+"'");var i="boundary_string",j=new e(i),k=new f;k.addHeader("Content-Disposition",'form-data; name="'+h.jsonPartName+'";'),k.addHeader("Content-Type","application/json"),k.setBody(b),j.addPart(k);var l=new f;l.addHeader("Content-Type","application/octet-stream"),l.addHeader("Content-Disposition",'form-data; name="'+h.binaryPartName+'"; filename="'+c+'"'),l.setBody(d),j.addPart(l);var m=new Uint8Array(j.getBuffer());return g.all(a).post(m,null,{"Content-Type":'multipart/form-data; boundary="'+i+'"'}).then(function(a){return a})},g}]),angular.module("ngForce").factory("sfrquery",["$q","$rootScope","$log","Restangular","encodeUriQuery",function(a,b,c,d,e){var f=d.withConfig(function(a){a.setDefaultHttpFields({cache:!1}),a.setBaseUrl("/services/data/v30.0/"),a.setDefaultHeaders({Authorization:"Bearer "+window.apiSid})}).setRestangularFields({id:"Id",selfLink:"attributes.url"}).oneUrl("query","/services/data/v30.0/query");return f.query=function(a,b){return b="undefined"!=typeof b?b:!1,f.withHttpConfig({cache:b}).get({q:a}).then(function(a){return a.records})},f.queryAll=function(b,c,d,g){return angular.isUndefined(c)&&(c=!0),angular.isUndefined(g)&&(g=[]),angular.isUndefined(d)&&(d=a.defer()),"select"===b.trim().substring(0,6).toLowerCase()&&(b="?q="+e(b)),f.withHttpConfig({cache:c}).customGET(b).then(function(a){return g=g.concat(a.records),a.done?(d.resolve(g),d.promise):void f.queryAll(_.last(a.nextRecordsUrl.split("/")),c,d,g)},function(a){return d.reject(a)}),d.notify(),d.promise},f}]),angular.module("ngForce").provider("vfr",function(){var a={escape:!1,timeout:1e4};if("object"!=typeof Visualforce)throw new Error("Visualforce is not available as an object! Did you forget to include the ngForce component?");return{setStandardOptions:function(b){if(b&&"object"!=typeof b)throw new Error("standardOptions must be an object");a=b},$get:["$q","$rootScope",function(b,c){return{send:function(a,c,d){var e,f,g,h=Visualforce.remoting.Manager,i=a.split(".");if(c&&"object"!=typeof c)throw new Error("Options must be an object");if(i.length<2)throw new Error("Invalid Remote Action specified. Use Controller.MethodName or $RemoteAction.Controller.MethodName");return 3===i.length?(e=i[0],f=i[1],g=i[2]):2===i.length&&(f=i[0],g=i[1]),function(){var e,f=b.defer();return e=arguments.length?Array.prototype.slice.apply(arguments):[],e.splice(0,0,a),e.push(function(a,b){handleResultWithPromise(a,b,d,f)}),c&&e.push(c),h.invokeAction.apply(h,e),f.promise}},handleResultWithPromise:function(a,b,d,e){a?("object"!=typeof a&&(a=JSON.parse(a)),Array.isArray(a)&&a[0].message&&a[0].errorCode?(e.reject(a),c.$safeApply()):(e.resolve(a),c.$safeApply())):"undefined"!=typeof d&&d?(e.resolve(),c.$safeApply()):(e.reject({message:"Null returned by RemoteAction not called with nullOk flag",errorCode:"NULL_RETURN"}),c.$safeApply())},bulkCreate:function(){send("ngForceController.bulkCreate",a,!1)},bulkUpdate:function(){send("ngForceController.bulkUpdate",a,!1)},create:function(){send("ngForceController.create",a,!1)},clone:function(){send("ngForceController.sObjectKlone",a,!1)},del:function(){send("ngForceController.del",a,!0)},describe:function(){send("ngForceController.describe",a,!1)},describeFieldSet:function(){send("ngForceController.describeFieldSet",a,!1)},describePicklistValues:function(){send("ngForceController.getPicklistValues",a,!1)},getObjectType:function(){send("ngForceController.getObjType",a,!1)},getQueryResultsAsSelect2Data:function(){send("ngForceController.getQueryResultsAsSelect2Data",a,!1)},query:function(){send("ngForceController.query",{escape:!1,timeout:3e4},!1)},queryFromFieldset:function(){send("ngForceController.queryFromFieldSet",{escape:!1,timeout:3e4},!1)},retrieve:function(){send("ngForceController.retrieve",a,!1)},search:function(){send("ngForceController.search",a,!1)},soqlFromFieldSet:function(){send("ngForceController.soqlFromFieldSet",a,!1)},update:function(){send("ngForceController.updat",a,!0)},upsert:function(){send("ngForceController.upser",a,!0)}}}]}}),angular.module("ngForce",["Scope.safeApply","restangular","multipart"]);
//# sourceMappingURL=ngForce.min.js.map